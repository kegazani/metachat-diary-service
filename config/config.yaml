# Сервис
service:
  name: "diary-service"
  version: "1.0.0"
  environment: "development"  # development, staging, production

# HTTP сервер
server:
  host: "0.0.0.0"
  port: "9093"
  read_timeout: "15s"
  write_timeout: "15s"
  idle_timeout: "60s"

# gRPC сервер
grpc:
  host: "0.0.0.0"
  port: "50052"
  timeout: "30s"

# Event Store
event_store:
  type: "eventstoredb"  # memory, eventstoredb
  url: "http://localhost:2113"  # Use localhost for local development, eventstore:2113 for Docker
  username: "admin"
  password: "changeit"
  stream_prefix: "metachat-diary"

# Cassandra
cassandra:
  hosts:
    - "localhost"
  port: "9042"
  keyspace: "metachat"
  consistency: "QUORUM"
  timeout: "10s"
  reconnect_interval: "10s"
  num_connections: 2
  # Для production:
  # username: "cassandra"
  # password: "cassandra"

# Kafka
kafka:
  brokers:
    - "localhost:9092"
  consumer_group: "diary-service-group"
  timeout: "10s"
  diary_events_topic: "diary-events"
  
  topics:
    diary_events: "diary-events"
    session_events: "session-events"
    diary_entry_created: "metachat.diary.entry.created"
    diary_entry_updated: "metachat.diary.entry.updated"
    diary_entry_deleted: "metachat.diary.entry.deleted"
    
  all_kafka_topics:
    user_service:
      - "metachat-user-events"
    diary_service:
      - "diary-events"
      - "session-events"
      - "metachat.diary.entry.created"
      - "metachat.diary.entry.updated"
      - "metachat.diary.entry.deleted"
    mood_analysis_service:
      - "metachat.diary.entry.created"
      - "metachat.diary.entry.updated"
      - "metachat.mood.analyzed"
      - "metachat.mood.analysis.failed"
    analytics_service:
      - "metachat.mood.analyzed"
      - "metachat.diary.entry.created"
      - "metachat.diary.entry.deleted"
      - "metachat.archetype.updated"
    archetype_service:
      - "metachat.mood.analyzed"
      - "metachat.diary.entry.created"
      - "metachat.archetype.assigned"
      - "metachat.archetype.updated"
      - "metachat.archetype.calculation.triggered"
    biometric_service:
      - "metachat.biometric.data.received"
    correlation_service:
      - "metachat.mood.analyzed"
      - "metachat.biometric.data.received"
      - "metachat.correlation.discovered"

# NATS (альтернатива Kafka)
# nats:
#   url: "nats://localhost:4222"
#   diary_events_subject: "diary.events"
#   session_events_subject: "session.events"
#   timeout: "10s"

# Логирование
logging:
  level: "info"  # debug, info, warn, error
  format: "json"  # json, text

# Метрики
metrics:
  enabled: true
  port: "9090"
  path: "/metrics"

# Безопасность
security:
  jwt_secret: "your-jwt-secret-key"
  jwt_expiration: "24h"

# Rate limiting
rate_limit:
  enabled: true
  requests_per_minute: 100
  burst: 200

# Health check
health:
  enabled: true
  endpoint: "/health"
  check_interval: "30s"